<script type="text/javascript">
  (function ($) {
    <% if flash %>
      $(function(){
        <% flash.each do |key, value| %>
          $.notify('<%= value %>', '<%= key %>');
        <% end %>
      });
    <% end %>

    $('.page').horizon();

    var ScrollToggle = function (top, callbackShow, callbackHide) {
      this.ontop = 0;
      this.hontop = 0;
      this.top = top - 20;
      this.show = callbackShow;
      this.hide = callbackHide;
      var self = this;

      (function () {
        $(window).scroll(function (event) {
          var y = getScrollTop();

          if (y >= self.top)
            self.ontop = 1;
          else
            self.ontop = 0;

          if (self.ontop !== self.hontop) {
            if (self.ontop) {
              self.show();
            }
            else {
              self.hide();
            }
          }
          self.hontop = (self.ontop * 1);
        });
      })();
    };

    var height = $(window).height();
    $('article').each(function(index) {
      var scroller1 = new ScrollToggle($(this).position().top + 150, function () {
        $('[data-slide-to="' + index + '"]').trigger('click');
      }, function () {
        $('[data-slide-to="' + (index - 1) + '"]').trigger('click');
      });
    });

    function getScrollTop() {
      if (typeof pageYOffset != 'undefined') {
        return pageYOffset;
      }
      else {
        var docBody = document.body;
        var docTypeBody = document.documentElement;
        docTypeBody = (docTypeBody.clientHeight) ? docTypeBody : docBody;
        return docTypeBody.scrollTop;
      }
    };
  })
  (jQuery);

</script>